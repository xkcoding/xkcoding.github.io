<!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2"><link rel="stylesheet" href="/lib/Han/dist/han.min.css?v=3.3"><meta name="google-site-verification" content="1QzehZlTl5aSnOCNs73zcBTKES4VP3lD03D9KydmKEE"><meta name="msvalidate.01" content="8BF7F99E04BB8024BEA713E231B70D39"><meta name="baidu-site-verification" content="GQoVEswEhI"><link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.png?v=7.0.0"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.png?v=7.0.0"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.png?v=7.0.0"><link rel="mask-icon" href="/favicon.png?v=7.0.0" color="#222"><script>!function(e,t,o,a,c,i,n){e.DaoVoiceObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,i=t.createElement(o),n=t.getElementsByTagName(o)[0],i.async=1,i.src=a,i.charset="utf-8",n.parentNode.insertBefore(i,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"80a62a84"}),daovoice("update")</script><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"7.0.0",sidebar:{position:"left",width:240,display:"always",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1,dimmer:!1},copycode:{enable:!0,show_result:!0,style:"mac"},fancybox:!0,fastclick:!0,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"ZV4RFZVZ58",apiKey:"ad1e0a485cd7b9e16a583282fc2843c6",indexName:"xkcoding",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="前言 scaffold: 脚手架的意思，是一款封装了一些通用组件的，让Spring Boot快速开发的工具集。"><meta name="keywords" content="spring boot,scaffold,开源"><meta property="og:type" content="article"><meta property="og:title" content="scaffold 组件相关文档"><meta property="og:url" content="https://xkcoding.com/2019/03/12/scaffold-doc.html"><meta property="og:site_name" content="CodingDiary"><meta property="og:description" content="前言 scaffold: 脚手架的意思，是一款封装了一些通用组件的，让Spring Boot快速开发的工具集。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-xmind-1.0.8.png"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-bom/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-launcher/badge.svg"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-edit_config.png"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-set_profiles.png"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-common/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-log/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-swagger/badge.svg"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-swagger.png"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-test/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-web/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-code/badge.svg"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-notification/badge.svg"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-dingtalk.png"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-email-simple.png"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-email-mime.png"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-sms.png"><meta property="og:image" content="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-codegen/badge.svg"><meta property="og:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-codegen.png"><meta property="og:updated_time" content="2022-10-04T22:31:35.222Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="scaffold 组件相关文档"><meta name="twitter:description" content="前言 scaffold: 脚手架的意思，是一款封装了一些通用组件的，让Spring Boot快速开发的工具集。"><meta name="twitter:image" content="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-xmind-1.0.8.png"><link rel="alternate" href="/atom.xml" title="CodingDiary" type="application/atom+xml"><link rel="canonical" href="https://xkcoding.com/2019/03/12/scaffold-doc.html"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>scaffold 组件相关文档 | CodingDiary</title><script async src="//www.googletagmanager.com/gtag/js?id=[object Object]"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","[object Object]")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?521f6d48d3fa40ce529ba993fc1a46b4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">CodingDiary</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">代码日记</h1></div><div class="site-nav-toggle"> <button aria-label="切换导航栏"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类<span class="badge">39</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签<span class="badge">57</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档<span class="badge">86</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-sitemap"><a href="/atom.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-wiki"><span class="exturl" data-url="aHR0cHM6Ly94a2NvZGluZy53aWtp"><i class="menu-item-icon fa fa-fw fa-code"></i><br>wiki</span></li><li class="menu-item menu-item-阅读"><span class="exturl" data-url="aHR0cHM6Ly9yZWFkaW5nLnhrY29kaW5nLmNvbQ=="><i class="menu-item-icon fa fa-fw fa-book"></i><br>阅读</span></li><li class="menu-item menu-item-友链"><a href="/links" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i><br>友链</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header> <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hrY29kaW5n" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#222;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></span><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div class="reading-progress-bar"></div><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xkcoding.com/2019/03/12/scaffold-doc.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="xkcoding"><meta itemprop="description" content="xkcoding的代码成长日记"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="CodingDiary"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">scaffold 组件相关文档<span class="exturl post-edit-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hrY29kaW5nL015QmxvZy9lZGl0L21hc3Rlci9zb3VyY2UvX3Bvc3RzLzIwMTktMDMtMTIuc2NhZmZvbGQtZG9jLm1k" title="编辑"><i class="fa fa-pencil"></i></span></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-03-12 09:51:34" itemprop="dateCreated datePublished" datetime="2019-03-12T09:51:34+08:00">2019-03-12</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/开源/" itemprop="url" rel="index"><span itemprop="name">开源</span></a></span> ， <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/开源/scaffold/" itemprop="url" rel="index"><span itemprop="name">scaffold</span></a></span></span> <span id="/2019/03/12/scaffold-doc.html" class="leancloud_visitors" data-flag-title="scaffold 组件相关文档"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span title="本文字数">25k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">23 分钟</span></div></div></header><div class="post-body han-init-context" itemprop="articleBody"><h2 id="intro">前言</h2> scaffold: 脚手架的意思，是一款封装了一些通用组件的，让Spring Boot快速开发的工具集。<a id="more"></a><h2 id="1-Scaffold组件图谱"><a class="header-anchor" href="#1-Scaffold组件图谱"></a>1. Scaffold组件图谱</h2> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-xmind-1.0.8.png"><h2 id="2-项目信息"><a class="header-anchor" href="#2-项目信息"></a>2. 项目信息</h2><p><strong>项目地址：</strong> <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hrY29kaW5nL3NjYWZmb2xk" title="https://github.com/xkcoding/scaffold">https://github.com/xkcoding/scaffold<i class="fa fa-external-link"></i></span></p><p><strong>目录结构：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scaffold</span><br><span class="line">├── scaffold-bom          scaffold依赖管理</span><br><span class="line">├── scaffold-common       通用工具类</span><br><span class="line">├── scaffold-launcher     通用启动器</span><br><span class="line">├── scaffold-log          日志包</span><br><span class="line">├── scaffold-swagger      swagger配置</span><br><span class="line">├── scaffold-test         通用单元测试</span><br><span class="line">├── scaffold-web          通用web配置</span><br><span class="line">├── scaffold-code         通用验证码组件</span><br><span class="line">├── scaffold-notification 通用通知组件</span><br><span class="line">└── scaffold-codegen      代码生成器</span><br></pre></td></tr></table></figure><p><strong>版本更新记录：</strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hrY29kaW5nL3NjYWZmb2xkL2Jsb2IvbWFzdGVyL0NIQU5HRUxPRy5tZA==" title="https://github.com/xkcoding/scaffold/blob/master/CHANGELOG.md">CHANGELOG<i class="fa fa-external-link"></i></span></p><h2 id="3-安装方式"><a class="header-anchor" href="#3-安装方式"></a>3.安装方式</h2><p><span class="inline-img">当前最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZA==" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-$&#123;模块名&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;最新版本&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-各个模块功能介绍及使用方法"><a class="header-anchor" href="#4-各个模块功能介绍及使用方法"></a>4. 各个模块功能介绍及使用方法</h2><h3 id="4-1-scaffold-bom-版本依赖管理"><a class="header-anchor" href="#4-1-scaffold-bom-版本依赖管理"></a>4.1. scaffold-bom 版本依赖管理</h3><h4 id="主要功能"><a class="header-anchor" href="#主要功能"></a>主要功能</h4><p>用于统一管理 <code>scaffold</code> 的版本，不需要用户控制各个模块的版本依赖</p><h4 id="使用方法"><a class="header-anchor" href="#使用方法"></a>使用方法</h4><p><span class="inline-img"><code>scaffold-bom</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1ib20=" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-bom"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-bom/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-bom<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-bom.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--不需要定义版本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-$&#123;模块名&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-2-scaffold-launcher-启动器模块"><a class="header-anchor" href="#4-2-scaffold-launcher-启动器模块"></a>4.2. scaffold-launcher 启动器模块</h3><h4 id="主要功能-2"><a class="header-anchor" href="#主要功能-2"></a>主要功能</h4><ol><li><p>环境划分：dev（开发）、test（测试）、prod（正式），默认 dev。</p></li><li><p>启动器配置，代码中可以注入 <code>ScaffoldProperties</code> 来读取启动器的一些配置信息，比如 <code>env</code> 等。</p><p><code>scaffold.prop</code> 可以在配置文件中<code>自定义配置</code>。然后再在代码中使用 <code>ScaffoldProperties</code> 读取。</p></li><li><p>插件扩展，更加方便的去注入一些通用配置，降低使用难度。插件扩展基于 java SPI 技术，关于 java SPI 具体使用可以百度。</p></li></ol><blockquote><p>注意：如果使用了 scaffold-launcher，单元测试需要使用 scaffold-test 组件，使用方法<a href="#4-6-scaffold-test-%E9%80%9A%E7%94%A8%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%BB%84%E4%BB%B6">请看文档</a></p></blockquote><h4 id="使用方法-2"><a class="header-anchor" href="#使用方法-2"></a>使用方法</h4><h5 id="①-创建spring-boot-项目"><a class="header-anchor" href="#①-创建spring-boot-项目"></a>① 创建spring boot 项目</h5><h5 id="②-添加依赖"><a class="header-anchor" href="#②-添加依赖"></a>② 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-launcher</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1sYXVuY2hlcg==" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-launcher"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-launcher/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-launcher<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-launcher.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="③-修改启动类代码"><a class="header-anchor" href="#③-修改启动类代码"></a>③ 修改启动类代码</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// SpringApplication.run(DemoApplication.class, args);</span></span><br><span class="line">        ScaffoldApplication.run(<span class="string">"demo"</span>, DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="④-设置使用环境"><a class="header-anchor" href="#④-设置使用环境"></a>④ 设置使用环境</h5><ol><li><p>java命令行：<code>java -jar app.jar --spring.profiles.active=dev</code></p></li><li><p>JAVA_OPS：<code>set JAVA_OPTS=&quot;-Dspring.profiles.active=test&quot;</code></p></li><li><p>注解方式（代码层面，junit单元测试非常实用）：<code>@ActiveProfiles({&quot;dev&quot;,&quot;test&quot;})</code></p></li><li><p>ENV方式：系统环境变量SPRING_PROFILES_ACTIVE（注意：是大写）</p></li><li><p>idea开发场景下设置参考下图</p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-edit_config.png" width="30%"> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-set_profiles.png" width="90%"></li></ol><h5 id="⑤-自定义配置项"><a class="header-anchor" href="#⑤-自定义配置项"></a>⑤ 自定义配置项</h5><p><code>ScaffoldProperties.java</code></p><table><thead><tr><th>配置项</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>scaffold.env</td><td>dev</td><td>【只读】scaffold 环境变量，方便在代码中获取，设置无效</td></tr><tr><td><span class="exturl" data-url="aHR0cDovL3NjYWZmb2xkLm5hbWU=" title="http://scaffold.name">scaffold.name<i class="fa fa-external-link"></i></span></td><td>无</td><td>【只读】当前服务名称</td></tr><tr><td>scaffold.is-local</td><td>false</td><td>【只读】判断是否为 本地开发环境</td></tr><tr><td>scaffold.prop</td><td>无</td><td>装载自定义配置 <span class="exturl" data-url="aHR0cDovL3NjYWZmb2xkLnByb3AueHh4" title="http://scaffold.prop.xxx">scaffold.prop.xxx<i class="fa fa-external-link"></i></span></td></tr></tbody></table><p>在 <code>application.yml</code> 中配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scaffold:</span></span><br><span class="line"><span class="attr">  prop:</span></span><br><span class="line"><span class="attr">    author:</span> <span class="string">xkcoding</span></span><br><span class="line"><span class="attr">    blog:</span> <span class="attr">https://xkcoding.com</span></span><br></pre></td></tr></table></figure><p>使用配置</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ScaffoldProperties scaffoldProperties;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String author = scaffoldProperties.get(<span class="string">"author"</span>);</span><br><span class="line">    String blog = scaffoldProperties.get(<span class="string">"blog"</span>);</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="⑥-自定义启动插件"><a class="header-anchor" href="#⑥-自定义启动插件"></a>⑥ 自定义启动插件</h5><p>实现 LauncherService，重写 launcher 方法，下面是 LauncherService 的代码。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LauncherService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 启动时 处理 SpringApplicationBuilder</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> builder SpringApplicationBuilder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> appName 服务名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> profile 配置名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> isLocalDev 是否本地开发</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">launcher</span><span class="params">(SpringApplicationBuilder builder, String appName, String profile, <span class="keyword">boolean</span> isLocalDev)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编写 SPI 文件放置到 resources 目录下，文件路径和文件名 <code>META-INF/services/com.xkcoding.launcher.service.LauncherService</code>。</p><p>内容为你编写的插件完整类名，例如：<code>com.xxxx.CustomLauncherServiceImpl</code>。</p><h3 id="4-3-scaffold-common-通用工具"><a class="header-anchor" href="#4-3-scaffold-common-通用工具"></a>4.3. scaffold-common 通用工具</h3><h4 id="主要功能-3"><a class="header-anchor" href="#主要功能-3"></a>主要功能</h4><ol><li>通用API层返回格式封装</li><li>通用分页查询参数封装</li><li>常用工具类封装</li></ol><h4 id="使用方法-3"><a class="header-anchor" href="#使用方法-3"></a>使用方法</h4><h5 id="①-添加依赖"><a class="header-anchor" href="#①-添加依赖"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-common</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1jb21tb24=" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-common"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-common/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-common.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-统一API返回格式"><a class="header-anchor" href="#②-统一API返回格式"></a>② 统一API返回格式</h5><blockquote><p>类名：<code>com.xkcoding.common.api.R</code></p></blockquote><p>判断返回是否为成功：<code>R.isSuccess(R result);</code></p><p>判断返回是否为不成功：<code>R.isNotSuccess(R result);</code></p><p>获取data：<code>R.getData(R result);</code></p><p>返回成功：<code>R.success();</code></p><p>成功-携带数据：<code>R.success(Object data);</code></p><p>根据状态返回成功或者失败：<code>R.status(boolean status, String msg);</code></p><p>根据状态返回成功或者失败：<code>R.status(boolean status, IResultCode sCode);</code></p><p>返回失败信息：<code>R.fail();</code></p><p>返回失败信息，用于 web：<code>R.fail(String msg);</code></p><p>返回失败信息：<code>R.fail(IResultCode rCode);</code></p><p>返回失败信息：<code>R.fail(IResultCode rCode, String msg);</code></p><p>返回失败信息：<code>R.fail(int code, String msg);</code></p><p>返回失败信息-携带数据：<code>R.fail(IResultCode rCode, T data);</code></p><h5 id="③-状态码接口"><a class="header-anchor" href="#③-状态码接口"></a>③ 状态码接口</h5><blockquote><p>类名：<code>com.xkcoding.common.api.IResultCode</code></p></blockquote><h5 id="④-内置状态码"><a class="header-anchor" href="#④-内置状态码"></a>④ 内置状态码</h5><table><thead><tr><th>枚举值</th><th>状态码</th><th>描述</th></tr></thead><tbody><tr><td>ResultCode.SUCCESS</td><td>200</td><td>操作成功</td></tr><tr><td>ResultCode.FAILURE</td><td>-1</td><td>业务异常</td></tr><tr><td>ResultCode.UN_AUTHORIZED</td><td>401</td><td>请求未授权</td></tr><tr><td>ResultCode.NOT_FOUND</td><td>404</td><td>没找到请求</td></tr><tr><td>ResultCode.MSG_NOT_READABLE</td><td>400</td><td>消息不能读取</td></tr><tr><td>ResultCode.METHOD_NOT_SUPPORTED</td><td>405</td><td>不支持当前请求方法</td></tr><tr><td>ResultCode.MEDIA_TYPE_NOT_SUPPORTED</td><td>415</td><td>不支持当前媒体类型</td></tr><tr><td>ResultCode.REQ_REJECT</td><td>403</td><td>请求被拒绝</td></tr><tr><td>ResultCode.INTERNAL_SERVER_ERROR</td><td>500</td><td>服务器异常</td></tr><tr><td>ResultCode.PARAM_MISS</td><td>400</td><td>缺少必要的请求参数</td></tr><tr><td>ResultCode.PARAM_TYPE_ERROR</td><td>400</td><td>请求参数类型错误</td></tr><tr><td>ResultCode.PARAM_BIND_ERROR</td><td>400</td><td>请求参数绑定错误</td></tr><tr><td>ResultCode.PARAM_VALID_ERROR</td><td>400</td><td>参数校验失败</td></tr></tbody></table><h5 id="⑤-常用工具类"><a class="header-anchor" href="#⑤-常用工具类"></a>⑤ 常用工具类</h5><p>已经内置 <code>hutool</code> 工具类，额外新增<code>TreeUtil</code>(树节点操作)、<code>IpUtil</code>(获取IP信息)、<code>UrlUtil</code>(URL编解码)、<code>Ip2AddressUtil</code>(根据IP获取地址信息)、<code>WebUtil</code>(Web 工具类，操作 request/response/cookie)、<code>ServletUtil</code>(Servlet 工具类)等</p><h3 id="4-4-scaffold-log-通用日志组件"><a class="header-anchor" href="#4-4-scaffold-log-通用日志组件"></a>4.4. scaffold-log 通用日志组件</h3><h4 id="主要功能-4"><a class="header-anchor" href="#主要功能-4"></a>主要功能</h4><ol><li>对操作日志进行封装 <code>@ApiLog</code>，自定义操作人，以及自定义日志处理</li><li>基于<code>Spring Event</code>异步处理日志信息</li></ol><h4 id="使用方法-4"><a class="header-anchor" href="#使用方法-4"></a>使用方法</h4><h5 id="①-添加依赖-2"><a class="header-anchor" href="#①-添加依赖-2"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-log</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1sb2c=" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-log"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-log/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-log<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-log.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-application-yml-中开启操作日志拦截"><a class="header-anchor" href="#②-application-yml-中开启操作日志拦截"></a>② <code>application.yml</code> 中开启操作日志拦截</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scaffold:</span></span><br><span class="line"><span class="attr">  log:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h5 id="③-Controller层添加注解-ApiLog"><a class="header-anchor" href="#③-Controller层添加注解-ApiLog"></a>③ Controller层添加注解<code>@ApiLog</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@ApiLog</span>(<span class="string">"测试操作"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> R&lt;User&gt; <span class="title">test</span><span class="params">(@RequestBody User user)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> R.data(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="④-自定义日志操作"><a class="header-anchor" href="#④-自定义日志操作"></a>④ 自定义日志操作</h5><p>创建一个类，继承 <code>DefaultScaffoldLogServiceImpl</code>（也可以实现<code>LogService</code>接口） 重写对应方法，不需要全部重写，只需要重写部分即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomLogServiceImpl</span> <span class="keyword">extends</span> <span class="title">DefaultScaffoldLogServiceImpl</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存操作日志</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> logApi 操作日志实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 是否保存成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R&lt;Boolean&gt; <span class="title">saveApiLog</span><span class="params">(LogApi logApi)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 自定义操作，比如保存到数据库中</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.saveApiLog(logApi);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存错误日志</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> logError 错误日志实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 是否保存成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R&lt;Boolean&gt; <span class="title">saveErrorLog</span><span class="params">(LogError logError)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 自定义操作，比如保存到数据库中</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.saveErrorLog(logError);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存自定义日志</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> logCustom 自定义日志实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 是否保存成功</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R&lt;Boolean&gt; <span class="title">saveCustomLog</span><span class="params">(LogCustom logCustom)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 自定义操作，比如保存到数据库中</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.saveCustomLog(logCustom);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再将自定义的日志操作放到 Spring 容器中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LogService <span class="title">logService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CustomLogServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意：如果当前 <code>scaffold-launcher</code> 配置的 <code>spring.profiles.active</code> 环境是 <code>dev、test</code> 则日志实体里会拦截到请求中的参数等信息，如果是 <code>prod</code> 则不会拦截请求参数</p></blockquote><h5 id="⑤-自定义当前操作人"><a class="header-anchor" href="#⑤-自定义当前操作人"></a>⑤ 自定义当前操作人</h5><p><code>scaffold-log</code> 中默认当前操作人为 <code>匿名用户</code> ，用户可以通过实现 <code>SecurityService</code> 接口，重写 <code>getCurrentUserName</code> 实现自己的业务逻辑，之后务必加到 Spring 容器中，操作同上，不再赘述。</p><h3 id="4-5-scaffold-swagger-通用swagger配置"><a class="header-anchor" href="#4-5-scaffold-swagger-通用swagger配置"></a>4.5. scaffold-swagger 通用swagger配置</h3><h4 id="主要功能-5"><a class="header-anchor" href="#主要功能-5"></a>主要功能</h4><p>集成swagger的自动装配，方便集成</p><h4 id="使用方法-5"><a class="header-anchor" href="#使用方法-5"></a>使用方法</h4><h5 id="①-添加依赖-3"><a class="header-anchor" href="#①-添加依赖-3"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-swagger</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1zd2FnZ2Vy" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-swagger"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-swagger/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-swagger<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-swagger.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-配置swagger基础信息"><a class="header-anchor" href="#②-配置swagger基础信息"></a>② 配置swagger基础信息</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#swagger配置信息</span></span><br><span class="line"><span class="attr">swagger:</span></span><br><span class="line"><span class="attr">  title:</span> <span class="string">Demo</span> <span class="string">接口文档系统</span></span><br><span class="line"><span class="attr">  description:</span> <span class="string">Demo</span> <span class="string">接口文档系统</span></span><br><span class="line"><span class="attr">  version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">  license:</span> <span class="string">Powered</span> <span class="string">By</span> <span class="string">xkcoding</span></span><br><span class="line">  <span class="comment"># 注意这里必须配置你当前项目的包名</span></span><br><span class="line"><span class="attr">  base-package:</span> <span class="string">com.example.demo.controller</span></span><br><span class="line"><span class="attr">  contact:</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">Yangkai.Shen</span></span><br><span class="line"><span class="attr">    email:</span> <span class="number">237497819</span><span class="string">@qq.com</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://xkcoding.com</span></span><br></pre></td></tr></table></figure><h5 id="③-启动项目"><a class="header-anchor" href="#③-启动项目"></a>③ 启动项目</h5><p>访问 <code>http://${host}:${port}/${contextPath}/doc.html</code>，比如：<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlbW8vZG9jLmh0bWw=" title="http://localhost:8080/demo/doc.html">http://localhost:8080/demo/doc.html<i class="fa fa-external-link"></i></span></p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-swagger.png"><blockquote><p>注意：如果当前 <code>scaffold-launcher</code> 配置的 <code>spring.profiles.active</code> 环境是 <code>dev、test</code> 则可以访问接口文档，如果是 <code>prod</code> 则访问不到。</p></blockquote><h3 id="4-6-scaffold-test-通用单元测试组件"><a class="header-anchor" href="#4-6-scaffold-test-通用单元测试组件"></a>4.6. scaffold-test 通用单元测试组件</h3><h4 id="主要功能-6"><a class="header-anchor" href="#主要功能-6"></a>主要功能</h4><p>由于在 <code>scaffold-launcher</code> 里设置了一些启动参数，所以提供了 <code>scaffold-test</code> 方便在单元测试的时候使用。</p><h4 id="使用方法-6"><a class="header-anchor" href="#使用方法-6"></a>使用方法</h4><h5 id="①-添加依赖-4"><a class="header-anchor" href="#①-添加依赖-4"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-test</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC10ZXN0" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-test"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-test/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-test.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-单元测试一"><a class="header-anchor" href="#②-单元测试一"></a>② 单元测试一</h5><p>采用 <code>@RunWith(ScaffoldSpringRunner.class)</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@ScaffoldTest</span>(profile = <span class="string">"dev"</span>,appName = <span class="string">"demo-test"</span>)</span><br><span class="line"><span class="meta">@RunWith</span>(ScaffoldSpringRunner.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="③单元测试二"><a class="header-anchor" href="#③单元测试二"></a>③单元测试二</h5><p>继承 <code>ScaffoldBaseTest</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@ScaffoldTest</span>(profile = <span class="string">"dev"</span>,appName = <span class="string">"demo-test"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoTests</span> <span class="keyword">extends</span> <span class="title">ScaffoldBaseTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-7-scaffold-web-通用web配置"><a class="header-anchor" href="#4-7-scaffold-web-通用web配置"></a>4.7. scaffold-web 通用web配置</h3><h4 id="主要功能-7"><a class="header-anchor" href="#主要功能-7"></a>主要功能</h4><ol><li>Redis序列化配置</li><li>Jackson序列化配置</li><li>通用全局异常拦截配置，未知异常触发 Event 事件，由 <code>scaffold-log</code> 监听处理</li><li><code>dev、test</code> 环境下打印请求明细，方便代码调试</li><li>异步线程池通用配置</li><li>Mybatis-Plus 配置，<code>dev、test</code> 环境下启用SQL执行效率插件</li></ol><h4 id="使用方法-7"><a class="header-anchor" href="#使用方法-7"></a>使用方法</h4><h5 id="①-添加依赖-5"><a class="header-anchor" href="#①-添加依赖-5"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-web</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC13ZWI=" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-web"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-web/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-web.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-异步线程池配置"><a class="header-anchor" href="#②-异步线程池配置"></a>② 异步线程池配置</h5><table><thead><tr><th>配置项</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>scaffold.async.corePoolSize</td><td>2</td><td>异步核心线程数，默认：2</td></tr><tr><td>scaffold.async.maxPoolSize</td><td>50</td><td>异步最大线程数，默认：50</td></tr><tr><td>scaffold.async.queueCapacity</td><td>10000</td><td>队列容量，默认：10000</td></tr><tr><td>scaffold.async.keepAliveSeconds</td><td>300</td><td>线程存活时间，默认：300</td></tr></tbody></table><h5 id="③-监控打印请求"><a class="header-anchor" href="#③-监控打印请求"></a>③ 监控打印请求</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2019-03-13 15:38:11.650  INFO 6846 --- [  XNIO-1 task-2] com.xkcoding.web.logger.RequestLogAspect : RequestLogAspect.java:157 - </span><br><span class="line">================  Request Start  ================</span><br><span class="line">===&gt; POST: /demo/ Parameters: &#123;<span class="string">"name"</span>:<span class="string">""</span>,<span class="string">"id"</span>:0,<span class="string">"age"</span>:0,<span class="string">"email"</span>:<span class="string">""</span>&#125;</span><br><span class="line">===headers===  Origin : http://localhost:8080</span><br><span class="line">===headers===  Cookie : Hm_lvt_bc38887aa5588add05a38704342ad7e8=1549855562; Hm_lvt_521f6d48d3fa40ce529ba993fc1a46b4=1548829297,1551345825; scroll-cookie=1900|/</span><br><span class="line">===headers===  Request-Origion : SwaggerBootstrapUi</span><br><span class="line">===headers===  Accept : */*</span><br><span class="line">===headers===  X-Requested-With : XMLHttpRequest</span><br><span class="line">===headers===  User-Agent : Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 Safari/537.36 QQBrowser/4.5.121.400</span><br><span class="line">===headers===  Connection : keep-alive</span><br><span class="line">===headers===  Referer : http://localhost:8080/demo/doc.html</span><br><span class="line">===headers===  Host : localhost:8080</span><br><span class="line">===headers===  Accept-Encoding : gzip, deflate, br</span><br><span class="line">===headers===  Accept-Language : zh-CN,zh;q=0.9</span><br><span class="line">===headers===  Content-Length : 50</span><br><span class="line">===headers===  Content-Type : application/json</span><br><span class="line">===Result===  &#123;<span class="string">"msg"</span>:<span class="string">"操作成功"</span>,<span class="string">"code"</span>:200,<span class="string">"data"</span>:&#123;<span class="string">"name"</span>:<span class="string">""</span>,<span class="string">"id"</span>:0,<span class="string">"age"</span>:0,<span class="string">"email"</span>:<span class="string">""</span>&#125;,<span class="string">"success"</span>:<span class="literal">true</span>&#125;</span><br><span class="line">&lt;=== POST: /demo/ (2 ms)</span><br><span class="line">================   Request End   ================</span><br></pre></td></tr></table></figure><h3 id="4-8-scaffold-code-通用验证码组件"><a class="header-anchor" href="#4-8-scaffold-code-通用验证码组件"></a>4.8. scaffold-code 通用验证码组件</h3><h4 id="主要功能-8"><a class="header-anchor" href="#主要功能-8"></a>主要功能</h4><ol><li>随机验证码，可配置随机验证码的字符串、长度、宽度、高度</li><li>简单算术验证码，可配置验证码宽度、高度</li></ol><h4 id="使用方法-8"><a class="header-anchor" href="#使用方法-8"></a>使用方法</h4><blockquote><p>注意：验证码组件需要配合缓存使用，建议使用Redis</p></blockquote><h5 id="①-添加依赖-6"><a class="header-anchor" href="#①-添加依赖-6"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-code</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1jb2Rl" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-code"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-code/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-code<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-code.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-在-application-yml-中开启验证码，同时设置Redis相关配置"><a class="header-anchor" href="#②-在-application-yml-中开启验证码，同时设置Redis相关配置"></a>② 在 <code>application.yml</code> 中开启验证码，同时设置Redis相关配置</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scaffold:</span></span><br><span class="line"><span class="attr">  code:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="comment"># 连接超时时间（记得添加单位，Duration）</span></span><br><span class="line"><span class="attr">    timeout:</span> <span class="number">10000</span><span class="string">ms</span></span><br><span class="line">    <span class="comment"># Redis默认情况下有16个分片，这里配置具体使用的分片</span></span><br><span class="line">    <span class="comment"># database: 0</span></span><br><span class="line"><span class="attr">    lettuce:</span></span><br><span class="line"><span class="attr">      pool:</span></span><br><span class="line">        <span class="comment"># 连接池最大连接数（使用负值表示没有限制） 默认 8</span></span><br><span class="line"><span class="attr">        max-active:</span> <span class="number">8</span></span><br><span class="line">        <span class="comment"># 连接池最大阻塞等待时间（使用负值表示没有限制） 默认 -1</span></span><br><span class="line"><span class="attr">        max-wait:</span> <span class="bullet">-1</span><span class="string">ms</span></span><br><span class="line">        <span class="comment"># 连接池中的最大空闲连接 默认 8</span></span><br><span class="line"><span class="attr">        max-idle:</span> <span class="number">8</span></span><br><span class="line">        <span class="comment"># 连接池中的最小空闲连接 默认 0</span></span><br><span class="line"><span class="attr">        min-idle:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line">    <span class="comment"># 一般来说是不用配置的，Spring Cache 会根据依赖的包自行装配</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">redis</span></span><br></pre></td></tr></table></figure><h5 id="③-自定义配置项"><a class="header-anchor" href="#③-自定义配置项"></a>③ 自定义配置项</h5><table><thead><tr><th>配置项</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>scaffold.code.enabled</td><td>false</td><td>是否开启验证码</td></tr><tr><td>scaffold.code.cookie-name</td><td>scaffold-code</td><td>验证码默认cookie名</td></tr><tr><td>scaffold.code.cache-name</td><td>SCAFFOLD::CODE</td><td>验证码默认缓存</td></tr><tr><td>scaffold.code.pool</td><td>ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</td><td>验证码生成策略，默认：大写字母+数字</td></tr><tr><td>scaffold.code.width</td><td>108</td><td>验证码宽度</td></tr><tr><td>scaffold.code.height</td><td>40</td><td>验证码高度</td></tr><tr><td>scaffold.code.length</td><td>4</td><td>验证码长度</td></tr></tbody></table><h5 id="④-示例代码"><a class="header-anchor" href="#④-示例代码"></a>④ 示例代码</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ScaffoldCode scaffoldCode;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/code/math.jpg"</span>, produces = MediaType.IMAGE_JPEG_VALUE)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="title">mathCode</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scaffoldCode.generateMathCode(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/verify/math/&#123;code&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> R&lt;Boolean&gt; <span class="title">verifyMathCode</span><span class="params">(HttpServletResponse response, @PathVariable String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = scaffoldCode.validateMath(response, code);</span><br><span class="line">        <span class="keyword">return</span> R.status(flag, <span class="string">"验证码错误"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/code/random.jpg"</span>, produces = MediaType.IMAGE_JPEG_VALUE)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="title">randomCode</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scaffoldCode.generateRandomCode(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/verify/random/&#123;code&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> R&lt;Boolean&gt; <span class="title">verifyCode</span><span class="params">(HttpServletResponse response, @PathVariable String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = scaffoldCode.validateRandom(response, code);</span><br><span class="line">        <span class="keyword">return</span> R.status(flag, <span class="string">"验证码错误"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-9-scaffold-notification-通用通知组件"><a class="header-anchor" href="#4-9-scaffold-notification-通用通知组件"></a>4.9. scaffold-notification 通用通知组件</h3><h4 id="主要功能-9"><a class="header-anchor" href="#主要功能-9"></a>主要功能</h4><ol><li><p>钉钉机器人通知，支持多种消息类型，包括text类型、link类型、markdown类型、整体跳转ActionCard类型、独立跳转ActionCard类型、FeedCard类型</p></li><li><p>短信通知，集成阿里大鱼短信服务，稳定、快速</p></li><li><p>邮件通知，支持多种类型邮件，包括简单文本邮件、HTML模板邮件、附件、静态资源</p></li></ol><h4 id="使用方法-9"><a class="header-anchor" href="#使用方法-9"></a>使用方法</h4><h5 id="①-添加依赖-7"><a class="header-anchor" href="#①-添加依赖-7"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-notification</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1ub3RpZmljYXRpb24=" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-notification"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-notification/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-notification<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-notification.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-在-application-yml-中开启不同类型的通知配置，如果使用邮件通知类型，一定需要额外配置邮箱信息"><a class="header-anchor" href="#②-在-application-yml-中开启不同类型的通知配置，如果使用邮件通知类型，一定需要额外配置邮箱信息"></a>② 在 <code>application.yml</code> 中开启不同类型的通知配置，如果使用邮件通知类型，<code>一定需要</code>额外配置邮箱信息</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scaffold:</span></span><br><span class="line"><span class="attr">  notification:</span></span><br><span class="line"><span class="attr">    dingtalk:</span></span><br><span class="line"><span class="attr">      enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment"># 钉钉机器人 webhook 地址</span></span><br><span class="line"><span class="attr">      webhook:</span> <span class="attr">https://oapi.dingtalk.com/robot/send?access_token=xxxxxxxx</span></span><br><span class="line"><span class="attr">    email:</span></span><br><span class="line"><span class="attr">      enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    aliyun:</span></span><br><span class="line"><span class="attr">      enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment"># 阿里云 AccessKey ID</span></span><br><span class="line"><span class="attr">      access-key:</span> <span class="string">***********</span></span><br><span class="line">      <span class="comment"># 阿里云 Access Key Secret</span></span><br><span class="line"><span class="attr">      secret-key:</span> <span class="string">***********</span></span><br><span class="line">      <span class="comment"># 参见阿里大鱼短信服务的模板管理，格式为：模版名称:模版CODE，注意模板名称不能为中文</span></span><br><span class="line"><span class="attr">      channels:</span></span><br><span class="line"><span class="attr">        article_notification:</span> <span class="string">SMS_160576086</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  mail:</span></span><br><span class="line">    <span class="comment"># 邮箱 smtp 服务器地址</span></span><br><span class="line"><span class="attr">    host:</span> <span class="string">smtp.qq.com</span></span><br><span class="line">    <span class="comment"># 邮箱 smtp 服务器端口，一般存在ssl和非ssl的区别，比如QQ邮箱ssl端口为465，非ssl端口为587</span></span><br><span class="line"><span class="attr">    port:</span> <span class="number">465</span></span><br><span class="line">    <span class="comment"># 你的邮箱地址</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">********@qq.com</span></span><br><span class="line">    <span class="comment"># 你的邮箱密码</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">********</span></span><br><span class="line"><span class="attr">    protocol:</span> <span class="string">smtp</span></span><br><span class="line"><span class="attr">    test-connection:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    default-encoding:</span> <span class="string">UTF-8</span></span><br><span class="line"><span class="attr">    properties:</span></span><br><span class="line">      <span class="string">mail.smtp.auth:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment"># 下面三项根据自己邮箱是否使用ssl端口来设置，使用ssl为true，不使用ssl为false</span></span><br><span class="line">      <span class="string">mail.smtp.starttls.enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="string">mail.smtp.starttls.required:</span> <span class="literal">true</span></span><br><span class="line">      <span class="string">mail.smtp.ssl.enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h5 id="③-自定义配置项-2"><a class="header-anchor" href="#③-自定义配置项-2"></a>③ 自定义配置项</h5><table><thead><tr><th>配置项</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>scaffold.notification.dingtalk.enabled</td><td>false</td><td>是否启用钉钉机器人通知</td></tr><tr><td>scaffold.notification.dingtalk.webhook</td><td>无</td><td>钉钉机器人webhook地址</td></tr><tr><td>scaffold.notification.aliyun.enabled</td><td>false</td><td>是否启用阿里大鱼短信通知</td></tr><tr><td>scaffold.notification.aliyun.access-key</td><td>无</td><td>阿里云 AccessKey</td></tr><tr><td>scaffold.notification.aliyun.secret-key</td><td>无</td><td>阿里云 AccessSecret</td></tr><tr><td>scaffold.notification.aliyun.channels</td><td>无</td><td>模板与模板CODE的映射关系，参见阿里大鱼短信服务的模板管理，格式为：<code>模版名称:模版CODE</code>，注意模板名称不能为中文</td></tr><tr><td>scaffold.notification.email.enabled</td><td>false</td><td>是否启用邮箱通知，如果启用，<code>一定需要</code>额外配置邮箱信息</td></tr><tr><td>scaffold.notification.email.prefix</td><td>classpath:/email/</td><td>邮件模板位置</td></tr><tr><td>scaffold.notification.email.suffix</td><td>.html</td><td>邮件模板后缀</td></tr></tbody></table><h5 id="④-示例代码-2"><a class="header-anchor" href="#④-示例代码-2"></a>④ 示例代码</h5><p>在 <code>application.yml</code> 中，配置好上述配置后，可参考如下代码，实现钉钉、短信、邮箱三种类型的消息通知</p><blockquote><p>这里钉钉消息，只演示了 text 类型和 link 类型，其余类型，可以举一反三实现，官方文档地址：<span class="exturl" data-url="aHR0cHM6Ly9vcGVuLWRvYy5kaW5ndGFsay5jb20vbWljcm9hcHAvc2VydmVyYXBpMi9xZjJueHE=" title="https://open-doc.dingtalk.com/microapp/serverapi2/qf2nxq">https://open-doc.dingtalk.com/microapp/serverapi2/qf2nxq<i class="fa fa-external-link"></i></span></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xkcoding.scaffold.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.io.resource.ResourceUtil;</span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Maps;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.constants.EmailType;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.dingtalk.Attention;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.dingtalk.Link;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.dingtalk.LinkDingTalkMessage;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.dingtalk.TextDingTalkMessage;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.email.EmailMessage;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.model.sms.SmsMessage;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.service.dingtalk.DingTalkMessageSender;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.service.email.EmailMessageSender;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.notification.service.sms.SmsAliyunMessageSender;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.test.ScaffoldBaseTest;</span><br><span class="line"><span class="keyword">import</span> com.xkcoding.scaffold.test.ScaffoldTest;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.assertj.core.util.Lists;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 通知测试</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span>: com.xkcoding.scaffold.demo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: 通知测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: yangkai.shen</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: Created in 2019-03-18 22:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@copyright</span>: Copyright (c) 2019</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@modified</span>: yangkai.shen</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@ScaffoldTest</span>(profile = <span class="string">"prod"</span>, appName = <span class="string">"scaffold-notification-test"</span>)</span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationTest</span> <span class="keyword">extends</span> <span class="title">ScaffoldBaseTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DingTalkMessageSender dingTalkMessageSender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmailMessageSender emailMessageSender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SmsAliyunMessageSender smsAliyunMessageSender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTextDingTalk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TextDingTalkMessage textDingTalkMessage = <span class="keyword">new</span> TextDingTalkMessage();</span><br><span class="line"></span><br><span class="line">        textDingTalkMessage.setText(<span class="keyword">new</span> TextDingTalkMessage.Text(<span class="string">"你好，我是钉钉机器人"</span>));</span><br><span class="line">        textDingTalkMessage.setAt(<span class="keyword">new</span> Attention(Lists.newArrayList( <span class="string">"17326075631"</span>), <span class="keyword">false</span>));</span><br><span class="line">        dingTalkMessageSender.execute(textDingTalkMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLinkDingTalk</span><span class="params">()</span></span>&#123;</span><br><span class="line">        LinkDingTalkMessage linkDingTalkMessage = <span class="keyword">new</span> LinkDingTalkMessage();</span><br><span class="line">        Link link = <span class="keyword">new</span> Link();</span><br><span class="line">        link.setMessageUrl(<span class="string">"https://xkcoding.com"</span>);</span><br><span class="line">        link.setText(<span class="string">"代码日记更新博客了。。。。。"</span>);</span><br><span class="line">        link.setTitle(<span class="string">"博客更新"</span>);</span><br><span class="line">        linkDingTalkMessage.setLink(link);</span><br><span class="line">        dingTalkMessageSender.execute(linkDingTalkMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSimpleEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        EmailMessage emailMessage = <span class="keyword">new</span> EmailMessage();</span><br><span class="line">        emailMessage.setEmailType(EmailType.SIMPLE);</span><br><span class="line">        emailMessage.setTos(Lists.newArrayList(<span class="string">"237497819@qq.com"</span>));</span><br><span class="line">        emailMessage.setFrom(<span class="string">"xkcoding"</span>);</span><br><span class="line">        emailMessage.setSubject(<span class="string">"简单邮件标题"</span>);</span><br><span class="line">        emailMessage.setContent(<span class="string">"这是一封简单邮件的内容"</span>);</span><br><span class="line">        emailMessageSender.execute(emailMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMimeEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        EmailMessage emailMessage = <span class="keyword">new</span> EmailMessage();</span><br><span class="line">        emailMessage.setEmailType(EmailType.MIME);</span><br><span class="line">        emailMessage.setTos(Lists.newArrayList(<span class="string">"237497819@qq.com"</span>));</span><br><span class="line">        emailMessage.setFrom(<span class="string">"xkcoding"</span>);</span><br><span class="line">        emailMessage.setSubject(<span class="string">"复杂邮件标题"</span>);</span><br><span class="line">        <span class="comment">// 设置模板，位置：resources/email/template.html</span></span><br><span class="line">        emailMessage.setTemplate(<span class="string">"template"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置变量</span></span><br><span class="line">        Map&lt;String, Object&gt; params = Maps.newHashMap();</span><br><span class="line">        params.put(<span class="string">"project"</span>, <span class="string">"Spring Boot Demo"</span>);</span><br><span class="line">        params.put(<span class="string">"author"</span>, <span class="string">"Yangkai.Shen"</span>);</span><br><span class="line">        params.put(<span class="string">"url"</span>, <span class="string">"https://github.com/xkcoding/spring-boot-demo"</span>);</span><br><span class="line">        emailMessage.setParams(params);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置附件，文件位置：resources/db/data-h2.sql、resources/db/schema-h2.sql</span></span><br><span class="line">        URL data = ResourceUtil.getResource(<span class="string">"db/data-h2.sql"</span>);</span><br><span class="line">        URL schema = ResourceUtil.getResource(<span class="string">"db/schema-h2.sql"</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;EmailMessage.Attachment&gt; attachments = Lists.newArrayList(<span class="keyword">new</span> EmailMessage.Attachment(<span class="string">"data.sql"</span>, <span class="keyword">new</span> File(data</span><br><span class="line">                .getPath())), <span class="keyword">new</span> EmailMessage.Attachment(<span class="string">"schema.sql"</span>, <span class="keyword">new</span> File(schema.getPath())));</span><br><span class="line">        emailMessage.setAttachments(attachments);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置静态资源，图片位置：resources/static/favicon.png</span></span><br><span class="line">        URL favicon = ResourceUtil.getResource(<span class="string">"static/favicon.png"</span>);</span><br><span class="line">        List&lt;EmailMessage.StaticResource&gt; staticResources = Lists.newArrayList(<span class="keyword">new</span> EmailMessage.StaticResource(<span class="string">"favicon"</span>, <span class="keyword">new</span> File(favicon</span><br><span class="line">                .getPath())));</span><br><span class="line">        emailMessage.setStaticResources(staticResources);</span><br><span class="line"></span><br><span class="line">        emailMessageSender.execute(emailMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSmsAliyunMessageSender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SmsMessage smsMessage = <span class="keyword">new</span> SmsMessage();</span><br><span class="line">        smsMessage.setMobile(<span class="string">"17326075631"</span>);</span><br><span class="line">        Map&lt;String, String&gt; params = Maps.newHashMap();</span><br><span class="line">        <span class="comment">// 根据短信模板里的变量设置参数</span></span><br><span class="line">        <span class="comment">// 此处我的模板内容为：尊敬的读者，代码日记发布文章《$&#123;article&#125;》，欢迎阅读！</span></span><br><span class="line">        params.put(<span class="string">"article"</span>, <span class="string">"scaffold-doc"</span>);</span><br><span class="line">        smsMessage.setParams(params);</span><br><span class="line">        smsMessage.setSignName(<span class="string">"代码日记"</span>);</span><br><span class="line">        smsMessage.setTemplate(<span class="string">"article_notification"</span>);</span><br><span class="line">        smsMessage.setType(<span class="string">"短信通知"</span>);</span><br><span class="line">        smsAliyunMessageSender.execute(smsMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>邮件模板</strong>，位置：<code>resources/email/template.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>SpringBootDemo(入门SpringBoot的首选Demo)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        body &#123;</span></span><br><span class="line"><span class="undefined">            text-align: center;</span></span><br><span class="line"><span class="undefined">            margin-left: auto;</span></span><br><span class="line"><span class="undefined">            margin-right: auto;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        #welcome &#123;</span></span><br><span class="line"><span class="undefined">            text-align: center;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"welcome"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align: center; padding: 10px"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"cid:favicon"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>欢迎使用 <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;project&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> - Powered By <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">" $&#123;author&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align: center; padding: 10px"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">"text-decoration: none;"</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;$&#123;url&#125;&#125;"</span> <span class="attr">target</span>=<span class="string">"_bank"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">strong</span>&gt;</span>spring-boot-demo，入门Spring Boot的首选Demo！:)<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align: center; padding: 4px"</span>&gt;</span></span><br><span class="line">        如果对你有帮助,请任意打赏</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 100%;height: 100%;text-align: center;display: flex"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"flex: 1;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display: flex;width: 400px;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"flex: 1;text-align: center;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"180px"</span> <span class="attr">height</span>=<span class="string">"180px"</span> <span class="attr">src</span>=<span class="string">"http://xkcoding.com/resources/wechat-reward-image.png"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>微信打赏<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"flex: 1;text-align: center;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"180px"</span> <span class="attr">height</span>=<span class="string">"180px"</span> <span class="attr">src</span>=<span class="string">"http://xkcoding.com/resources/alipay-reward-image.png"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>支付宝打赏<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"flex: 1;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="⑤-效果图"><a class="header-anchor" href="#⑤-效果图"></a>⑤ 效果图</h5><p><strong>钉钉消息</strong></p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-dingtalk.png" width="60%"><p><strong>简单邮件</strong></p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-email-simple.png"><p><strong>复杂邮件</strong></p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-email-mime.png"><p><strong>短信</strong></p> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-notification-sms.png" width="40%/"><h5 id="⑥-文档参考"><a class="header-anchor" href="#⑥-文档参考"></a>⑥ 文档参考</h5><ul><li>钉钉机器人：<span class="exturl" data-url="aHR0cHM6Ly9vcGVuLWRvYy5kaW5ndGFsay5jb20vbWljcm9hcHAvc2VydmVyYXBpMi9xZjJueHE=" title="https://open-doc.dingtalk.com/microapp/serverapi2/qf2nxq">https://open-doc.dingtalk.com/microapp/serverapi2/qf2nxq<i class="fa fa-external-link"></i></span></li><li>阿里大鱼：<span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmFsaXl1bi5jb20vZG9jdW1lbnRfZGV0YWlsLzEwMTMwMC5odG1s" title="https://help.aliyun.com/document_detail/101300.html">https://help.aliyun.com/document_detail/101300.html<i class="fa fa-external-link"></i></span></li></ul><h3 id="4-10-scaffold-codegen-代码生成器"><a class="header-anchor" href="#4-10-scaffold-codegen-代码生成器"></a>4.10. scaffold-codegen 代码生成器</h3><h4 id="主要功能-10"><a class="header-anchor" href="#主要功能-10"></a>主要功能</h4><ol><li>支持生成前端api、Controller、Mapper、Service、Model代码，暂时仅支持mysql数据源</li><li>Controller、Model代码集成swagger注解</li><li>提供前端下载页面</li></ol><h4 id="使用方法-10"><a class="header-anchor" href="#使用方法-10"></a>使用方法</h4><h5 id="①-添加依赖-8"><a class="header-anchor" href="#①-添加依赖-8"></a>① 添加依赖</h5><blockquote><p>推荐使用 <code>scaffold-bom</code> 管理 <code>scaffold</code> 模块版本，使用方法<a href="#4-1-scaffold-bom-%E7%89%88%E6%9C%AC%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">请看文档</a></p></blockquote><p><span class="inline-img"><code>scaffold-codegen</code> 最新版本: <span class="exturl" data-url="aHR0cHM6Ly9tYXZlbi1iYWRnZXMuaGVyb2t1YXBwLmNvbS9tYXZlbi1jZW50cmFsL2NvbS54a2NvZGluZy9zY2FmZm9sZC1jb2RlZ2Vu" title="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-codegen"><img class="nofancybox" src="https://maven-badges.herokuapp.com/maven-central/com.xkcoding/scaffold-codegen/badge.svg"><i class="fa fa-external-link"></i></span></span></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xkcoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scaffold-codegen<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;scaffold-codegen.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="②-自定义配置项"><a class="header-anchor" href="#②-自定义配置项"></a>② 自定义配置项</h5><table><thead><tr><th>配置项</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>scaffold.codegen.author</td><td>com.xkcoding</td><td>基础包名</td></tr><tr><td>scaffold.codegen.base-package-name</td><td>codegen</td><td>模块名</td></tr><tr><td>scaffold.codegen.module-name</td><td>Yangkai.Shen</td><td>作者</td></tr><tr><td>scaffold.codegen.table-prefix</td><td>tb_</td><td>表前缀(类名不会包含表前缀)</td></tr></tbody></table><h5 id="③-在application-yml中添加数据源信息"><a class="header-anchor" href="#③-在application-yml中添加数据源信息"></a>③ 在application.yml中添加数据源信息</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://localhost:3306/spring-boot-demo</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure><h5 id="④-启动项目，访问-http-localhost-8080-demo-codegen-html"><a class="header-anchor" href="#④-启动项目，访问-http-localhost-8080-demo-codegen-html"></a>④ 启动项目，访问 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlbW8vY29kZWdlbi5odG1s" title="http://localhost:8080/demo/codegen.html">http://localhost:8080/demo/codegen.html<i class="fa fa-external-link"></i></span></h5> <img src="https://static.xkcoding.com/blog/scaffold-doc/image-scaffold-codegen.png"><blockquote><p>注意：如果当前 <code>scaffold-launcher</code> 配置的 <code>spring.profiles.active</code> 环境是 <code>dev、test</code> 则可以访问接口文档，如果是 <code>prod</code> 则访问不到。</p></blockquote><h2 id="TODO"><a class="header-anchor" href="#TODO"></a>TODO</h2><ul><li><strong>scaffold-cache</strong> 通用基于redis或者ehcache的缓存配置，设计缓存key，保证全系统key统一</li><li><strong>scaffold-auth</strong> 通用认证授权配置</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束&nbsp;<i class="fa fa-paw"></i>&nbsp;感谢您的阅读-------------</div></div></div><div><div id="wechat_subscriber" style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"> <img id="wechat_subscriber_qcode" src="/images/qrcode_for_xkcoding.jpg" alt="xkcoding wechat" style="width:200px;max-width:100%"><div>欢迎来我的公众号「xkcoding小凯扣丁」逛逛</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>o(╯□╰)o 赞助一杯咖啡 ~~</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/resources/wechat-reward-image.png" alt="xkcoding 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/resources/alipay-reward-image.png" alt="xkcoding 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> xkcoding</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://xkcoding.com/2019/03/12/scaffold-doc.html" title="scaffold 组件相关文档">https://xkcoding.com/2019/03/12/scaffold-doc.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/spring-boot/" rel="tag"><i class="fa fa-tag"></i> spring boot</a><a href="/tags/scaffold/" rel="tag"><i class="fa fa-tag"></i> scaffold</a><a href="/tags/开源/" rel="tag"><i class="fa fa-tag"></i> 开源</a></div><div class="post-widgets"><div class="social_share"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/02/18/use-mybatis-dynamic-sql-to-build-common-custom-advance-query.html" rel="next" title="使用Mybatis动态SQL构建通用自定义高级查询"><i class="fa fa-chevron-left"></i> 使用Mybatis动态SQL构建通用自定义高级查询</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2019/04/24/use-vagrant-build-linux-virtual-machine.html" rel="prev" title="Mac下使用Vagrant快速搭建Centos/7虚拟机">Mac下使用Vagrant快速搭建Centos/7虚拟机<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="xkcoding"><p class="site-author-name" itemprop="name">xkcoding</p><p class="site-description motion-element" itemprop="description">xkcoding的代码成长日记</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">86</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">39</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">57</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hrY29kaW5n" title="GitHub &rarr; https://github.com/xkcoding"><i class="fa fa-fw fa-github"></i> GitHub</span></span><span class="links-of-author-item"><span class="exturl" data-url="bWFpbHRvOjIzNzQ5NzgxOUBxcS5jb20=" title="邮箱 &rarr; mailto:237497819@qq.com"><i class="fa fa-fw fa-envelope"></i> 邮箱</span></span><span class="links-of-author-item"><span class="exturl" data-url="dGVuY2VudDovL21lc3NhZ2UvP21lbnU9eWVzJnVpbj0yMzc0OTc4MTkmd2Vic2l0ZW5hbWU9aW0ucXEuY29t" title="QQ &rarr; tencent://message/?menu=yes&uin=237497819&websitename=im.qq.com"><i class="fa fa-fw fa-qq"></i> QQ</span></span><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly93d3cud2VpYm8uY29tL3hrY29kaW5n" title="微博 &rarr; https://www.weibo.com/xkcoding"><i class="fa fa-fw fa-weibo"></i> 微博</span></span><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9jaGVuLXlhbmcta2FpLTYyL2FjdGl2aXRpZXM=" title="知乎 &rarr; https://www.zhihu.com/people/chen-yang-kai-62/activities"><i class="fa fa-fw fa-globe"></i> 知乎</span></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS &rarr; /atom.xml"><i class="fa fa-fw fa-rss"></i> RSS</a></span></div><div class="cc-license motion-element" itemprop="license"> <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span></div><div class="site-author motion-element"> <img class="mp-image" src="/images/qrcode_for_xkcoding.jpg" alt="xkcoding小凯扣丁"><p class="site-description">xkcoding小凯扣丁</p><p class="site-description motion-element">欢迎来我的公众号逛逛！</p></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#intro"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Scaffold组件图谱"><span class="nav-text">1. Scaffold组件图谱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-项目信息"><span class="nav-text">2. 项目信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-安装方式"><span class="nav-text">3.安装方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-各个模块功能介绍及使用方法"><span class="nav-text">4. 各个模块功能介绍及使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-scaffold-bom-版本依赖管理"><span class="nav-text">4.1. scaffold-bom 版本依赖管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法"><span class="nav-text">使用方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-scaffold-launcher-启动器模块"><span class="nav-text">4.2. scaffold-launcher 启动器模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-2"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-2"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-创建spring-boot-项目"><span class="nav-text">① 创建spring boot 项目</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-添加依赖"><span class="nav-text">② 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-修改启动类代码"><span class="nav-text">③ 修改启动类代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-设置使用环境"><span class="nav-text">④ 设置使用环境</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑤-自定义配置项"><span class="nav-text">⑤ 自定义配置项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑥-自定义启动插件"><span class="nav-text">⑥ 自定义启动插件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-scaffold-common-通用工具"><span class="nav-text">4.3. scaffold-common 通用工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-3"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-3"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-统一API返回格式"><span class="nav-text">② 统一API返回格式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-状态码接口"><span class="nav-text">③ 状态码接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-内置状态码"><span class="nav-text">④ 内置状态码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑤-常用工具类"><span class="nav-text">⑤ 常用工具类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-scaffold-log-通用日志组件"><span class="nav-text">4.4. scaffold-log 通用日志组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-4"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-4"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-2"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-application-yml-中开启操作日志拦截"><span class="nav-text">② application.yml 中开启操作日志拦截</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-Controller层添加注解-ApiLog"><span class="nav-text">③ Controller层添加注解@ApiLog</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-自定义日志操作"><span class="nav-text">④ 自定义日志操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑤-自定义当前操作人"><span class="nav-text">⑤ 自定义当前操作人</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-scaffold-swagger-通用swagger配置"><span class="nav-text">4.5. scaffold-swagger 通用swagger配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-5"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-5"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-3"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-配置swagger基础信息"><span class="nav-text">② 配置swagger基础信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-启动项目"><span class="nav-text">③ 启动项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-scaffold-test-通用单元测试组件"><span class="nav-text">4.6. scaffold-test 通用单元测试组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-6"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-6"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-4"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-单元测试一"><span class="nav-text">② 单元测试一</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③单元测试二"><span class="nav-text">③单元测试二</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-scaffold-web-通用web配置"><span class="nav-text">4.7. scaffold-web 通用web配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-7"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-7"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-5"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-异步线程池配置"><span class="nav-text">② 异步线程池配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-监控打印请求"><span class="nav-text">③ 监控打印请求</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-scaffold-code-通用验证码组件"><span class="nav-text">4.8. scaffold-code 通用验证码组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-8"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-8"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-6"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-在-application-yml-中开启验证码，同时设置Redis相关配置"><span class="nav-text">② 在 application.yml 中开启验证码，同时设置Redis相关配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-自定义配置项"><span class="nav-text">③ 自定义配置项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-示例代码"><span class="nav-text">④ 示例代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-scaffold-notification-通用通知组件"><span class="nav-text">4.9. scaffold-notification 通用通知组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-9"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-9"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-7"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-在-application-yml-中开启不同类型的通知配置，如果使用邮件通知类型，一定需要额外配置邮箱信息"><span class="nav-text">② 在 application.yml 中开启不同类型的通知配置，如果使用邮件通知类型，一定需要额外配置邮箱信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-自定义配置项-2"><span class="nav-text">③ 自定义配置项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-示例代码-2"><span class="nav-text">④ 示例代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑤-效果图"><span class="nav-text">⑤ 效果图</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#⑥-文档参考"><span class="nav-text">⑥ 文档参考</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-scaffold-codegen-代码生成器"><span class="nav-text">4.10. scaffold-codegen 代码生成器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要功能-10"><span class="nav-text">主要功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法-10"><span class="nav-text">使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#①-添加依赖-8"><span class="nav-text">① 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#②-自定义配置项"><span class="nav-text">② 自定义配置项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#③-在application-yml中添加数据源信息"><span class="nav-text">③ 在application.yml中添加数据源信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#④-启动项目，访问-http-localhost-8080-demo-codegen-html"><span class="nav-text">④ 启动项目，访问 http://localhost:8080/demo/codegen.html</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TODO"><span class="nav-text">TODO</span></a></li></ol></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> <span class="exturl" data-url="aHR0cDovL2JlaWFuLm1paXQuZ292LmNuLw==">浙ICP备15019787号-1</span> &copy; 2015 – <span itemprop="copyrightYear">2022</span><span class="with-love" id="animate"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">xkcoding</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">549k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">8:19</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> 访客数:</span><span class="site-uv" title="总访客量"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i> 阅读量:</span><span class="site-pv" title="总访问量"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/lib/reading_progress/reading_progress.js"></script><script src="/js/src/utils.js?v=7.0.0"></script><script src="/js/src/motion.js?v=7.0.0"></script><script src="/js/src/schemes/muse.js?v=7.0.0"></script><script src="/js/src/scrollspy.js?v=7.0.0"></script><script src="/js/src/post-details.js?v=7.0.0"></script><script src="/js/src/bootstrap.js?v=7.0.0"></script><script>var disqus_config=function(){this.page.url="https://xkcoding.com/2019/03/12/scaffold-doc.html",this.page.identifier="2019/03/12/scaffold-doc.html",this.page.title="scaffold 组件相关文档"};function loadComments(){var o=document,t=o.createElement("script");t.src="https://dai-ma-ri-ji.disqus.com/embed.js",t.setAttribute("data-timestamp",""+ +new Date),(o.head||o.body).appendChild(t)}$(function(){$("#comments").offset().top-$(window).height()<=0?loadComments():$(window).on("scroll.disqus_scroll",function(){$("#comments").offset().top-$(window).height()-$(window).scrollTop()<60&&($(window).off(".disqus_scroll"),loadComments())})})</script><script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      
        // ref: https://github.com/ForbesLindesay/unescape-html
        var unescapeHtml = function(html) {
          return String(html)
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, '\'')
            .replace(/&#x3A;/g, ':')
            // replace all the other &#x; chars
            .replace(/&#(\d+);/g, function (m, p) { return String.fromCharCode(p); })
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&amp;/g, '&');
        };
      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                content = unescapeHtml(content);
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .done(function() {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.time + 1);
              })
            
              .fail(function ({ responseJSON }) {
                console.log(`Failed to save Visitor num, with error message: ${responseJSON.error}`);
              })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1 }))
                .done(function() {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function() {
                  console.log('Failed to create');
                });
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log(`LeanCloud Counter Error: ${responseJSON.code} ${responseJSON.error}`);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'igdqTfV9rbtm7WF3pmcBo0fM-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'igdqTfV9rbtm7WF3pmcBo0fM-gzGzoHsz',
                'X-LC-Key': 'qJ9XOC1VMiPdYow77o4YVWMN',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"default",boxForm:"horizontal",position:"bottomCenter",networks:"QQZone,Wechat,Weibo,Douban,Mailto,Evernote,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"default",boxForm:"vertical",position:"middleRight",networks:"QQZone,Wechat,Weibo,Douban,Mailto,Evernote,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script src="/lib/pangu/dist/pangu.min.js?v=3.3"></script><script>pangu.spacingPage()</script><script src="/js/src/js.cookie.js?v=7.0.0"></script><script src="/js/src/scroll-cookie.js?v=7.0.0"></script><script src="/js/src/exturl.js?v=7.0.0"></script><script src="/lib/bookmark/bookmark.min.js?v=1.0"></script><script>bookmark.scrollToMark("auto","#更多")</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=document.createRange(),a=window.getSelection(),i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=i+"px",n.style.position="absolute",n.style.opacity="0",n.value=t,n.textContent=t,n.contentEditable=!0,n.readOnly=!1,document.body.appendChild(n),o.selectNode(n),a.removeAllRanges(),a.addRange(o),n.setSelectionRange(0,t.length),document.execCommand("copy")?$(this).text("复制成功"):$(this).text("复制失败"),n.blur(),$(this).blur()})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("复制")},300)}).append(t)})</script><script type="text/javascript" src="/js/clicklove.js"></script></body></html>